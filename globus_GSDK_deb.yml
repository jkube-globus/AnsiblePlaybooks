# Description
# ===========
# Enable required repos and install Globus Connect Server

- name: Setup Globus 
  hosts: globus
  user: centos

  #shell: "if test nohup.out; then rm -f nohup.out;fi && nohup /usr/sbin/globus-connect-server login localhost &> nohup.out && grep https nohup.out"
  tasks:
        - name: Install PIP
          apt:
                name: python3-pip
                state: latest
          become: True
          #when: ansible_facts['os_family'] == 'RedHat' and ansible_facts['distribution_major_version'] == '8'

        - name: Install Rust
          apt:
                name: rust
                state: latest
          become: True
          #when: ansible_facts['os_family'] == 'RedHat' and ansible_facts['distribution_major_version'] == '8'

        - name: Install Rust package manager
          apt:
                name: cargo
                state: latest
          become: True
          #when: ansible_facts['os_family'] == 'RedHat' and ansible_facts['distribution_major_version'] == '8'

        - name: Install wheel (PreReq) 
          pip:
            name: wheel
          become: True

        - name: Install setuptools_rust (PreReq) 
          pip:
            name: setuptools_rust
          become: True

        - name: Install Globus SDK
          pip:
            name: globus-sdk
          become: True
